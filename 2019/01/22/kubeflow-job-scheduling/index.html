<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.1"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>如何更換 Kubeflow 預設 Scheduling - Yi Yang&#039;s Blog</title><meta description="本篇文章將說明實作官網 [kubeflow&amp;#x2F;Job Scheduling]，所介紹的如何使用 gang-scheduling 更換原 kubeflow 預設 scheduler 機制。文章教學介紹透過使用kube-batch以支持 kubeflow 透過gang-scheduling排程方式，來同時允許多個Pod執行解決deadlock問題。  tf-operator 實現 gang-schedu"><meta property="og:type" content="blog"><meta property="og:title" content="如何更換 Kubeflow 預設 Scheduling"><meta property="og:url" content="http://yylin1.github.io/2019/01/22/kubeflow-job-scheduling/"><meta property="og:site_name" content="Yi Yang&#039;s Blog"><meta property="og:description" content="本篇文章將說明實作官網 [kubeflow&amp;#x2F;Job Scheduling]，所介紹的如何使用 gang-scheduling 更換原 kubeflow 預設 scheduler 機制。文章教學介紹透過使用kube-batch以支持 kubeflow 透過gang-scheduling排程方式，來同時允許多個Pod執行解決deadlock問題。  tf-operator 實現 gang-schedu"><meta property="og:locale" content="zh_TW"><meta property="og:image" content="http://yylin1.github.io/images/kubeflow-job-scheduling.png"><meta property="article:published_time" content="2019-01-22T15:34:29.000Z"><meta property="article:modified_time" content="2019-08-07T08:05:43.000Z"><meta property="article:author" content="Yi Yang"><meta property="article:tag" content="kubernetes"><meta property="article:tag" content="kubeflow"><meta property="article:tag" content="scheduler"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/images/kubeflow-job-scheduling.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://yylin1.github.io/2019/01/22/kubeflow-job-scheduling/"},"headline":"Yi Yang's Blog","image":["http://yylin1.github.io/images/kubeflow-job-scheduling.png"],"datePublished":"2019-01-22T15:34:29.000Z","dateModified":"2019-08-07T08:05:43.000Z","author":{"@type":"Person","name":"Yi Yang"},"description":"本篇文章將說明實作官網 [kubeflow&#x2F;Job Scheduling]，所介紹的如何使用 gang-scheduling 更換原 kubeflow 預設 scheduler 機制。文章教學介紹透過使用kube-batch以支持 kubeflow 透過gang-scheduling排程方式，來同時允許多個Pod執行解決deadlock問題。  tf-operator 實現 gang-schedu"}</script><link rel="canonical" href="http://yylin1.github.io/2019/01/22/kubeflow-job-scheduling/"><link rel="icon" href="/images/artificial-intelligence.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-dark.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/artificial-intelligence.png" alt="Yi Yang&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="http://photography.yylin.io">Photo</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="文章目錄" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜尋" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="thumbnail" src="/images/kubeflow-job-scheduling.png" alt="如何更換 Kubeflow 預設 Scheduling"></span></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-01-22T15:34:29.000Z" title="2019-01-22T15:34:29.000Z">2019-01-22</time><span class="level-item"><a class="link-muted" href="/categories/Kubeflow/">Kubeflow</a></span><span class="level-item">10 分鐘 閱讀文 (大約 1505 個字)</span></div></div><h1 class="title is-3 is-size-4-mobile">如何更換 Kubeflow 預設 Scheduling</h1><div class="content"><p>本篇文章將說明實作官網 <a href="https://www.kubeflow.org/docs/other-guides/job-scheduling/" target="_blank" rel="noopener">[kubeflow/Job Scheduling]</a>，所介紹的如何使用 <code>gang-scheduling</code> 更換原 kubeflow 預設 scheduler 機制。文章教學介紹透過使用<a href="https://github.com/kubernetes-sigs/kube-batch" target="_blank" rel="noopener">kube-batch</a>以支持 kubeflow 透過<code>gang-scheduling</code>排程方式，來同時允許多個Pod執行解決<code>deadlock</code>問題。</p>
<blockquote>
<p><strong>tf-operator 實現 gang-scheduler 已經從 <code>PDB</code> 轉換為 <code>PodGroups</code>已更新於文章</strong><br>請參考 <a href="https://github.com/kubernetes-sigs/kube-batch/blob/master/doc/usage/tutorial.md" target="_blank" rel="noopener">Kube-batch-tutorial</a> 介紹 or <a href="https://github.com/volcano-sh/volcano" target="_blank" rel="noopener">volcano</a></p>
</blockquote>
<a id="more"></a>
<p><strong>本篇實作主要感謝 @kubeflow member and Kubeflow/tf-operator reviewer <a href="https://github.com/ChanYiLin" target="_blank" rel="noopener">@Jack Lin</a> 撰寫的教學</strong></p>
<h2 id="實驗環境"><a href="#實驗環境" class="headerlink" title="實驗環境"></a>實驗環境</h2><p>本實驗環境為 kubernetes HA Cluster + 4*GPU Node :</p>
<ul>
<li>Kubernetes v1.11.2</li>
<li>Etcd v3.2.9</li>
<li>containerd v1.1.2</li>
</ul>
<table>
<thead>
<tr>
<th>IP Address</th>
<th>Hostname</th>
<th>CPU</th>
<th>Memory</th>
<th>Extra Device</th>
</tr>
</thead>
<tbody>
<tr>
<td>192.168.0.98</td>
<td>VIP</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>192.168.0.81</td>
<td>k8s-m1</td>
<td>4</td>
<td>16G</td>
<td>無</td>
</tr>
<tr>
<td>192.168.0.82</td>
<td>k8s-m2</td>
<td>4</td>
<td>16G</td>
<td>無</td>
</tr>
<tr>
<td>192.168.0.83</td>
<td>k8s-m3</td>
<td>4</td>
<td>16G</td>
<td>無</td>
</tr>
<tr>
<td>192.168.0.84</td>
<td>k8s-g1</td>
<td>4</td>
<td>16G</td>
<td>GTX 1060 6G</td>
</tr>
<tr>
<td>192.168.0.85</td>
<td>k8s-g2</td>
<td>4</td>
<td>16G</td>
<td>GTX 1060 6G</td>
</tr>
<tr>
<td>192.168.0.86</td>
<td>k8s-g3</td>
<td>4</td>
<td>16G</td>
<td>GTX 1060 6G</td>
</tr>
<tr>
<td>192.168.0.87</td>
<td>k8s-g4</td>
<td>4</td>
<td>16G</td>
<td>GTX 1060 6G</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="配置更換預設-scheduling"><a href="#配置更換預設-scheduling" class="headerlink" title="配置更換預設 scheduling"></a>配置更換預設 scheduling</h2><p>要讓環境使用<code>gang-scheduling</code>排程，必須先在叢集中安裝 <a href="https://github.com/kubernetes-sigs/kube-batch" target="_blank" rel="noopener">kube-batch</a> 作為 Kubernetes 額外可選擇的排程機制，並配置 operator 以啟用<code>gang-scheduling</code>。</p>
<h4 id="Note-by-job-scheduling"><a href="#Note-by-job-scheduling" class="headerlink" title="Note by job scheduling :"></a>Note by job scheduling :</h4><blockquote>
<ul>
<li>Kube-batch’s introduction is here, and also check how to install it here</li>
<li>Take tf-operator for example, enable gang-scheduling in tf-operator by setting true to <code>--enable-gang-scheduling</code> flag.</li>
</ul>
</blockquote>
<h3 id="1-kube-batch-install"><a href="#1-kube-batch-install" class="headerlink" title="1. kube-batch install"></a>1. kube-batch install</h3><p>參考<code>kube-batch</code> 詳細介紹與安裝方式<a href="https://github.com/kubernetes-sigs/kube-batch/blob/master/doc/usage/tutorial.md" target="_blank" rel="noopener">[tutorial]</a>，以下為實驗記錄。</p>
<p>在<code>叢集中</code> 安裝 Helm tool：</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ wget -qO- https://storage.googleapis.com/kubernetes-helm/helm-v2.12.2-linux-amd64.tar.gz | tar -zx</span><br><span class="line">$ sudo mv linux-amd64/helm /usr/<span class="hljs-built_in">local</span>/bin/</span><br></pre></td></tr></table></figure>
<p>初始化 Helm (並安裝 Tiller Server):</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl -n kube-system create sa tiller</span><br><span class="line">$ kubectl create clusterrolebinding tiller --clusterrole cluster-admin --serviceaccount=kube-system:tiller</span><br><span class="line">$ helm init --service-account tiller</span><br><span class="line"></span><br><span class="line">Tiller (the Helm server-side component) has been installed into your Kubernetes Cluster.</span><br><span class="line">Happy Helming!</span><br></pre></td></tr></table></figure>
<h3 id="Config-kube-batch-for-Kubernetes"><a href="#Config-kube-batch-for-Kubernetes" class="headerlink" title="# Config kube-batch for Kubernetes"></a># Config kube-batch for Kubernetes</h3><p>在<code>k8s-m1</code>節點上執行：</p>
<ul>
<li>Download kube-batch</li>
</ul>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir -p <span class="hljs-variable">$GOPATH</span>/src/github.com/kubernetes-sigs/</span><br><span class="line">$ <span class="hljs-built_in">cd</span> <span class="hljs-variable">$GOPATH</span>/src/github.com/kubernetes-sigs/</span><br><span class="line">$ git <span class="hljs-built_in">clone</span> http://github.com/kubernetes-sigs/kube-batch</span><br></pre></td></tr></table></figure>
<ul>
<li>Deploy kube-batch by Helm</li>
</ul>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$ helm install <span class="hljs-variable">$GOPATH</span>/src/github.com/kubernetes-sigs/kube-batch/deployment/kube-batch --namespace kube-system</span><br><span class="line">NAME:   mortal-buffalo</span><br><span class="line">LAST DEPLOYED: Sun Jan 20 19:12:50 2019</span><br><span class="line">NAMESPACE: kube-system</span><br><span class="line">STATUS: DEPLOYED</span><br><span class="line"></span><br><span class="line">RESOURCES:</span><br><span class="line">==&gt; v1beta1/CustomResourceDefinition</span><br><span class="line">NAME                                   AGE</span><br><span class="line">podgroups.scheduling.incubator.k8s.io  0s</span><br><span class="line">queues.scheduling.incubator.k8s.io     0s</span><br><span class="line"></span><br><span class="line">==&gt; v1/Deployment</span><br><span class="line">kube-batch  0s</span><br><span class="line"></span><br><span class="line">==&gt; v1/Pod(related)</span><br><span class="line"></span><br><span class="line">NAME                         READY  STATUS   RESTARTS  AGE</span><br><span class="line">kube-batch-5d7d955f84-jw8gx  0/1    Pending  0         0s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NOTES:</span><br><span class="line">The batch scheduler of Kubernetes.</span><br></pre></td></tr></table></figure>
<p>驗證 kube-batch 已部署於kubernetes：</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ helm list</span><br><span class="line">NAME           	REVISION	UPDATED                 	STATUS  	CHART           	APP VERSION	NAMESPACE</span><br><span class="line">zooming-cricket	1       	Wed May 15 15:07:04 2019	DEPLOYED	kube-batch-0.4.2	           	kube-system</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="2-新增-RBAC-給-kube-batch"><a href="#2-新增-RBAC-給-kube-batch" class="headerlink" title="2. 新增 RBAC 給 kube-batch"></a>2. 新增 RBAC 給 kube-batch</h3><p>GitHub 安裝 <code>kube-batch</code> 補充說明提到，需要自己額配置RBAC給<code>kube-bath</code></p>
<h4 id="Note-by-kube-batch"><a href="#Note-by-kube-batch" class="headerlink" title="Note by kube-batch :"></a>Note by kube-batch :</h4><blockquote>
<ul>
<li>kube-batch need to collect cluster information(such as Pod, Node, CRD, etc) for scheduling, so the service account used by the deployment must have permission to access those cluster resources, otherwise, kube-batch will fail to startup. </li>
<li>For users who are not familiar with Kubernetes RBAC, please copy the <code>example/role.yaml</code> into <code>$GOPATH/src/github.com/kubernetes-sigs/kube-batch/deployment/kube-batch/templates/</code> and reinstall batch.</li>
</ul>
</blockquote>
<p>創建 RBAC 「ServiceAccount」、「ClusterRoleBinding」，名稱並為<code>name: kube-batch</code>: </p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ cat &lt;&lt;EOF | kubectl create -f -</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1beta1</span><br><span class="line">kind: ClusterRoleBinding</span><br><span class="line">metadata:</span><br><span class="line">  name: default-sa-admin</span><br><span class="line">subjects:</span><br><span class="line">  - kind: ServiceAccount</span><br><span class="line">    name: default</span><br><span class="line">    namespace: kube-system</span><br><span class="line">roleRef:</span><br><span class="line">  kind: ClusterRole</span><br><span class="line">  name: cluster-admin</span><br><span class="line">  apiGroup: rbac.authorization.k8s.io</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="3-kube-batch-啟用-gang-scheduling-配置"><a href="#3-kube-batch-啟用-gang-scheduling-配置" class="headerlink" title="3. kube-batch 啟用 gang-scheduling 配置"></a>3. kube-batch 啟用 gang-scheduling 配置</h3><p>確認<code>叢集中</code> 所配置的 kubeflow Namespace 當前運行的 Deploment，並找到<code>tf-job-operator</code>: </p>
<ul>
<li>將以下規則添加到 tf-job-operator clusterrole 以授予 tf-job-operator 創建權限 <code>PodGroup</code></li>
</ul>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl -n kubeflow edit clusterrole  tf-job-operator</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">- apiGroups:</span><br><span class="line">  - scheduling.incubator.k8s.io</span><br><span class="line">  resources:</span><br><span class="line">  - podgroups</span><br><span class="line">  verbs:</span><br><span class="line">  - <span class="hljs-string">'*'</span></span><br></pre></td></tr></table></figure>
<ul>
<li>tf-operator 通過添加標記啟用 gang-scheduling <code>--enable-gang-scheduling=true</code></li>
</ul>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl -n kubeflow edit deployment tf-job-operator</span><br><span class="line">...</span><br><span class="line">spec:</span><br><span class="line">      containers:</span><br><span class="line">      - <span class="hljs-built_in">command</span>:</span><br><span class="line">        - /opt/kubeflow/tf-operator.v1beta2</span><br><span class="line">        - --alsologtostderr</span><br><span class="line">        - -v=1</span><br><span class="line">        - --<span class="hljs-built_in">enable</span>-gang-scheduling=<span class="hljs-literal">true</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h3 id="4-測試範例-配置-YAML-增加-PodGroups"><a href="#4-測試範例-配置-YAML-增加-PodGroups" class="headerlink" title="4. 測試範例 - 配置 YAML 增加 PodGroups"></a>4. 測試範例 - 配置 YAML 增加 PodGroups</h3><p>這邊要注意運行的範例 TFJob，需要配置對應 <code>scheduling.k8s.io/group-name: ${PodGroupName}</code> 已啟用 PodGroups，而名稱要與當前 Job <code>${name}</code>設定相同。</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: <span class="hljs-string">"kubeflow.org/v1beta1"</span></span><br><span class="line">kind: <span class="hljs-string">"TFJob"</span></span><br><span class="line">metadata:</span><br><span class="line">  name: <span class="hljs-string">"gang-scheduling-podgroup"</span></span><br><span class="line">spec:</span><br><span class="line">  cleanPodPolicy: None</span><br><span class="line">  tfReplicaSpecs:</span><br><span class="line">    Worker:</span><br><span class="line">      replicas: 2</span><br><span class="line">      restartPolicy: Never</span><br><span class="line">      template:</span><br><span class="line">        metadata:</span><br><span class="line">          annotations:</span><br><span class="line">            scheduling.k8s.io/group-name: <span class="hljs-string">"gang-scheduling-podgroup"</span></span><br><span class="line">        spec:</span><br><span class="line">          schedulerName: kube-batch</span><br><span class="line">          containers:</span><br><span class="line">            - name: tensorflow</span><br><span class="line">              image: gcr.io/kubeflow-examples/distributed_worker:v20181031-513e107c</span><br><span class="line">              resources:</span><br><span class="line">                limits:</span><br><span class="line">                  nvidia.com/gpu: 1</span><br></pre></td></tr></table></figure>
<h3 id="補充說明-TFJob-配置-YAML-實現-gang-scheduling"><a href="#補充說明-TFJob-配置-YAML-實現-gang-scheduling" class="headerlink" title="[補充說明] TFJob 配置 YAML 實現 gang-scheduling"></a>[補充說明] TFJob 配置 YAML 實現 gang-scheduling</h3><p>執行 <a href="https://www.kubeflow.org/docs/other-guides/job-scheduling/" target="_blank" rel="noopener">job-scheduling</a> 介紹的範例：</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: <span class="hljs-string">"kubeflow.org/v1beta1"</span></span><br><span class="line">kind: <span class="hljs-string">"TFJob"</span></span><br><span class="line">metadata:</span><br><span class="line">  name: <span class="hljs-string">"tfjob-gang-scheduling"</span></span><br><span class="line">  namespace: <span class="hljs-string">"kubeflow"</span></span><br><span class="line">spec:</span><br><span class="line">  tfReplicaSpecs:</span><br><span class="line">    Worker:</span><br><span class="line">      replicas: 1</span><br><span class="line">      template:</span><br><span class="line">        metadata:</span><br><span class="line">          annotations:</span><br><span class="line">            scheduling.k8s.io/group-name: <span class="hljs-string">"tfjob-gang-scheduling"</span></span><br><span class="line">        spec:</span><br><span class="line">          schedulerName: kube-batch</span><br><span class="line">          nodeSelector:</span><br><span class="line">             gpu: <span class="hljs-string">"1060g1"</span></span><br><span class="line">          containers:</span><br><span class="line">          - args:</span><br><span class="line">            - python</span><br><span class="line">            - tf_cnn_benchmarks.py</span><br><span class="line">            - --batch_size=4</span><br><span class="line">            - --model=inception3</span><br><span class="line">            - --variable_update=parameter_server</span><br><span class="line">            - --num_gpus=1</span><br><span class="line">            - --local_parameter_device=cpu</span><br><span class="line">            - --device=gpu</span><br><span class="line">            - --data_format=NHWC</span><br><span class="line">            image: yylin1/tf-benchmarks-gpu:gpu-v1</span><br><span class="line">            name: tensorflow</span><br><span class="line">            resources:</span><br><span class="line">              limits:</span><br><span class="line">                nvidia.com/gpu: 1</span><br><span class="line">            workingDir: /opt/tf-benchmarks/scripts/tf_cnn_benchmarks</span><br><span class="line">          restartPolicy: OnFailure</span><br><span class="line">    PS:</span><br><span class="line">      replicas: 1</span><br><span class="line">      template:</span><br><span class="line">        metadata:</span><br><span class="line">          annotations:</span><br><span class="line">            scheduling.k8s.io/group-name: <span class="hljs-string">"tfjob-gang-scheduling"</span></span><br><span class="line">        spec:</span><br><span class="line">          schedulerName: kube-batch</span><br><span class="line">          nodeSelector:</span><br><span class="line">             gpu: <span class="hljs-string">"1060g1"</span></span><br><span class="line">          containers:</span><br><span class="line">          - args:</span><br><span class="line">            - python</span><br><span class="line">            - tf_cnn_benchmarks.py</span><br><span class="line">            - --batch_size=4</span><br><span class="line">            - --model=inception3</span><br><span class="line">            - --variable_update=parameter_server</span><br><span class="line">            - --num_gpus=1</span><br><span class="line">            - --local_parameter_device=cpu</span><br><span class="line">            - --device=cpu</span><br><span class="line">            - --data_format=NHWC</span><br><span class="line">            image: yylin1/tf-benchmarks-gpu:gpu-v1</span><br><span class="line">            name: tensorflow</span><br><span class="line">            resources:</span><br><span class="line">              limits:</span><br><span class="line">                cpu: <span class="hljs-string">'1'</span></span><br><span class="line">            workingDir: /opt/tf-benchmarks/scripts/tf_cnn_benchmarks</span><br><span class="line">          restartPolicy: OnFailure</span><br></pre></td></tr></table></figure>
<ul>
<li><code>tfjob-gang-scheduling</code> yaml範例中，要使用kube-batch為選用的排程機制，這邊要在Spec指定 <code>schedulerName:kube-batch</code>。</li>
</ul>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">spec:</span><br><span class="line">         schedulerName: kube-batch</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="補充說明-gang-scheduling-實驗測試"><a href="#補充說明-gang-scheduling-實驗測試" class="headerlink" title="[補充說明] gang-scheduling 實驗測試"></a>[補充說明] gang-scheduling 實驗測試</h2><p>環境目前有<code>4個GPU Node節點</code>，運行流程先執行<code>yylin-job1</code>之後再執行<code>yylin-job2</code> 測試環境，以觀察:</p>
<ul>
<li>通過使用<code>kube-batch</code>來啟用<code>gang-scheduling</code>，而只有當有叢集環境中有足夠的資源執行給所有pod時，才能運行任務。否則所有pod將處於<code>Pending</code>狀態，等待足夠的資源。</li>
<li>若使用預設<code>kubeflow scheuler</code>會導致同一個Job資源不夠，但Worker照常運行，導致執行Job任務是無意義的。</li>
</ul>
<p>Job 配置：</p>
<ul>
<li>yylin-job1 <ul>
<li>Worker:3、PS:1</li>
</ul>
</li>
<li>yylin-job2<ul>
<li>Worker:2、PS:1</li>
</ul>
</li>
</ul>
<p>啟用<code>schedulerName: kube-batch</code>:</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl get pod -n kubeflow</span><br><span class="line">tfjob-gang-scheduling-ps-0                                1/1       Running             0          43s</span><br><span class="line">tfjob-gang-scheduling-worker-0                            1/1       Running             0          43s</span><br><span class="line">tfjob-gang-scheduling-worker-1                            1/1       Running             0          43s</span><br><span class="line">tfjob-gang-scheduling-worker-2                            1/1       Running             0          43s</span><br><span class="line">tfjob-gang-scheduling2-ps-0                               1/1       Running             0          38s</span><br><span class="line">tfjob-gang-scheduling2-worker-0                           0/1       Pending             0          38s</span><br><span class="line">tfjob-gang-scheduling2-worker-1                           0/1       Pending             0          38s</span><br></pre></td></tr></table></figure>
<p>預設<code>kubeflow scheuler</code>:</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl get pod -n kubeflow</span><br><span class="line">tfjob-gang-scheduling-ps-0                                1/1       Running             0          1m</span><br><span class="line">tfjob-gang-scheduling-worker-0                            1/1       Running             0          1m</span><br><span class="line">tfjob-gang-scheduling-worker-1                            1/1       Running             0          1m</span><br><span class="line">tfjob-gang-scheduling-worker-2                            1/1       Running             0          1m</span><br><span class="line">tfjob-gang-scheduling2-ps-0                               1/1       Running             0          34s</span><br><span class="line">tfjob-gang-scheduling2-worker-0                           1/1       Running             0          34s</span><br><span class="line">tfjob-gang-scheduling2-worker-1                           0/1       Pending             0          34s</span><br></pre></td></tr></table></figure>
<p>Reference: </p>
<ul>
<li><a href="https://www.kubeflow.org/docs/other-guides/job-scheduling//" target="_blank" rel="noopener">[kubeflow] [Job Scheduling- schedule a job with gang-scheduling]</a></li>
</ul>
</div><div class="article-tags size-small is-uppercase mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/kubernetes/">kubernetes</a><a class="link-muted mr-2" rel="tag" href="/tags/kubeflow/">kubeflow</a><a class="link-muted mr-2" rel="tag" href="/tags/scheduler/">scheduler</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2019/01/28/portainer-set-tls/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Portainer 透過 TLS 認證</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2019/01/19/bastion-host/"><span class="level-item">認識 Bastion Host 部署管理機</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">評論</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'http://yylin1.github.io/2019/01/22/kubeflow-job-scheduling/';
            this.page.identifier = '2019/01/22/kubeflow-job-scheduling/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'yylin' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="" src="/images/yiyang.png" alt="Yi Yang"></figure><p class="title is-size-4 is-block line-height-inherit">Yi Yang</p><p class="is-size-6 is-block">Software Engineer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Hsinchu, Taiwan</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">21</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分類</p><a href="/categories"><p class="title">10</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">標籤</p><a href="/tags"><p class="title">25</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/yylin1" target="_blank" rel="noopener">追蹤</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/yylin1"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com/frank.yiyanglin"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Envelope" href="mailto:frank.yylin@gmail.com"><i class="far fa-envelope"></i></a></div></div></div><div class="card widget" id="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">文章目錄</h3><ul class="menu-list"><li><a class="is-flex" href="#實驗環境"><span class="mr-2">1</span><span>實驗環境</span></a></li><li><a class="is-flex" href="#配置更換預設-scheduling"><span class="mr-2">2</span><span>配置更換預設 scheduling</span></a><ul class="menu-list"><ul class="menu-list"><li><a class="is-flex" href="#Note-by-job-scheduling"><span class="mr-2">2.1.1</span><span>Note by job scheduling :</span></a></li></ul><li><a class="is-flex" href="#1-kube-batch-install"><span class="mr-2">2.2</span><span>1. kube-batch install</span></a></li><li><a class="is-flex" href="#Config-kube-batch-for-Kubernetes"><span class="mr-2">2.3</span><span># Config kube-batch for Kubernetes</span></a></li><li><a class="is-flex" href="#2-新增-RBAC-給-kube-batch"><span class="mr-2">2.4</span><span>2. 新增 RBAC 給 kube-batch</span></a><ul class="menu-list"><li><a class="is-flex" href="#Note-by-kube-batch"><span class="mr-2">2.4.1</span><span>Note by kube-batch :</span></a></li></ul></li><li><a class="is-flex" href="#3-kube-batch-啟用-gang-scheduling-配置"><span class="mr-2">2.5</span><span>3. kube-batch 啟用 gang-scheduling 配置</span></a></li><li><a class="is-flex" href="#4-測試範例-配置-YAML-增加-PodGroups"><span class="mr-2">2.6</span><span>4. 測試範例 - 配置 YAML 增加 PodGroups</span></a></li><li><a class="is-flex" href="#補充說明-TFJob-配置-YAML-實現-gang-scheduling"><span class="mr-2">2.7</span><span>[補充說明] TFJob 配置 YAML 實現 gang-scheduling</span></a></li></ul></li><li><a class="is-flex" href="#補充說明-gang-scheduling-實驗測試"><span class="mr-2">3</span><span>[補充說明] gang-scheduling 實驗測試</span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">連結</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://chlin62.github.io/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">林大工程師</span></span><span class="level-right"><span class="level-item tag">chlin62.github.io</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">分類</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/Ansible/"><span class="level-start"><span class="level-item">Ansible</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Deploy/"><span class="level-start"><span class="level-item">Deploy</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Docker/"><span class="level-start"><span class="level-item">Docker</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Driver/"><span class="level-start"><span class="level-item">Driver</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Kubeflow/"><span class="level-start"><span class="level-item">Kubeflow</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Kubernetes/"><span class="level-start"><span class="level-item">Kubernetes</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Linkpack/"><span class="level-start"><span class="level-item">Linkpack</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Note/"><span class="level-start"><span class="level-item">Note</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Openshift/"><span class="level-start"><span class="level-item">Openshift</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Zabbix/"><span class="level-start"><span class="level-item">Zabbix</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><a class="media-left" href="/2020/06/16/singularity-introduction/"><p class="image is-64x64"><img class="thumbnail" src="/images/singularity.jpg" alt="Singularity 基礎介紹"></p></a><div class="media-content size-small"><p><time dateTime="2020-06-16T14:50:14.000Z">2020-06-16</time></p><p class="title is-6"><a class="link-muted" href="/2020/06/16/singularity-introduction/">Singularity 基礎介紹</a></p><p class="is-uppercase"></p></div></article><article class="media"><a class="media-left" href="/2019/12/31/2019-retrospect-prospect/"><p class="image is-64x64"><img class="thumbnail" src="/images/2019_end.png" alt="2019 年度總結"></p></a><div class="media-content size-small"><p><time dateTime="2019-12-31T03:50:00.000Z">2019-12-31</time></p><p class="title is-6"><a class="link-muted" href="/2019/12/31/2019-retrospect-prospect/">2019 年度總結</a></p><p class="is-uppercase"></p></div></article><article class="media"><a class="media-left" href="/2019/10/12/roca12day/"><p class="image is-64x64"><img class="thumbnail" src="/images/roca12.jpg" alt="中坑精南 補充兵 12 日心得"></p></a><div class="media-content size-small"><p><time dateTime="2019-10-12T06:38:05.000Z">2019-10-12</time></p><p class="title is-6"><a class="link-muted" href="/2019/10/12/roca12day/">中坑精南 補充兵 12 日心得</a></p><p class="is-uppercase"></p></div></article><article class="media"><a class="media-left" href="/2019/08/12/openshift-ansible-v3-11/"><p class="image is-64x64"><img class="thumbnail" src="/images/openshift%203.11.jpg" alt="透過 Ansible 快速部署 OpenShift 3.11(OKD) 叢集"></p></a><div class="media-content size-small"><p><time dateTime="2019-08-12T15:41:13.000Z">2019-08-12</time></p><p class="title is-6"><a class="link-muted" href="/2019/08/12/openshift-ansible-v3-11/">透過 Ansible 快速部署 OpenShift 3.11(OKD) 叢集</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Openshift/">Openshift</a></p></div></article><article class="media"><a class="media-left" href="/2019/05/03/minikube-for-kubeflow/"><p class="image is-64x64"><img class="thumbnail" src="/images/minikube_for_kubeflow.jpg" alt="利用 Minikube 快速測試部署 Kubeflow v0.5"></p></a><div class="media-content size-small"><p><time dateTime="2019-05-03T15:46:54.000Z">2019-05-03</time></p><p class="title is-6"><a class="link-muted" href="/2019/05/03/minikube-for-kubeflow/">利用 Minikube 快速測試部署 Kubeflow v0.5</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Kubeflow/">Kubeflow</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">彙整</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/06/"><span class="level-start"><span class="level-item">六月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/12/"><span class="level-start"><span class="level-item">十二月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/10/"><span class="level-start"><span class="level-item">十月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/08/"><span class="level-start"><span class="level-item">八月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/05/"><span class="level-start"><span class="level-item">五月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/02/"><span class="level-start"><span class="level-item">二月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/01/"><span class="level-start"><span class="level-item">一月 2019</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/12/"><span class="level-start"><span class="level-item">十二月 2018</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/11/"><span class="level-start"><span class="level-item">十一月 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/10/"><span class="level-start"><span class="level-item">十月 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/09/"><span class="level-start"><span class="level-item">九月 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">標籤</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/API/"><span class="tag">API</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Container/"><span class="tag">Container</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GPU/"><span class="tag">GPU</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NVIDIA-Driver/"><span class="tag">NVIDIA Driver</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Retrospect/"><span class="tag">Retrospect</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Singularity/"><span class="tag">Singularity</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/UI/"><span class="tag">UI</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ansible/"><span class="tag">ansible</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bastion/"><span class="tag">bastion</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/benchmark/"><span class="tag">benchmark</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/deploy/"><span class="tag">deploy</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/distributed/"><span class="tag">distributed</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker/"><span class="tag">docker</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kubecon/"><span class="tag">kubecon</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kubeflow/"><span class="tag">kubeflow</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kubernetes/"><span class="tag">kubernetes</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/linpack/"><span class="tag">linpack</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/microk8s/"><span class="tag">microk8s</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/minikube/"><span class="tag">minikube</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/openshift/"><span class="tag">openshift</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/parmeter-server/"><span class="tag">parmeter server</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/quickstart/"><span class="tag">quickstart</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/scheduler/"><span class="tag">scheduler</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ubuntu/"><span class="tag">ubuntu</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/zabbix/"><span class="tag">zabbix</span><span class="tag is-grey-lightest">2</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">訂閱 Email</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="訂閱"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/artificial-intelligence.png" alt="Yi Yang&#039;s Blog" height="28"></a><p class="size-small"><span>&copy; 2020 Yi Yang</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("zh-TW");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'http://yylin1.github.io',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到頁首" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="請輸入關鍵字..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"請輸入關鍵字...","untitled":"(Untitled)","posts":"文章","pages":"Pages","categories":"分類","tags":"標籤"});
        });</script></body></html>